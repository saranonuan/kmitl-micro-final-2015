{"version":3,"sources":["app.coffee"],"names":[],"mappings":"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","file":"app.js","sourceRoot":"/source/","sourcesContent":["online_timeouts = {}\nweb_timeouts = {}\n\n$(document).foundation();\nconsole.log(\"Load Foundation\");\n\nclient = new Paho.MQTT.Client(\"gis.it.kmitl.ac.th\", 3000, \"judge-web\");\nclient.onConnectionLost = (response) ->\n\tif response.errorCode != 0\n\t\tconsole.log(\"onConnectionLost:\" + response.errorMessage)\n\tconnect()\n\treturn;\n\ncallOnlineTimeout = (student_id) ->\n  $('#deviceStatus-' + student_id).prop( \"checked\", false );\n  delete online_timeouts[student_id]\n  console.log(\"Timeout Call\", student_id);\n\ncallOnlineWebTimeout = (student_id) ->\n  $('#deviceStatusWeb-' + student_id).prop( \"checked\", false );\n  delete web_timeouts[student_id]\n  console.log(\"Timeout Call\", student_id);\n\nclient.onMessageArrived = (message) ->\n\ttopic = message.destinationName\n\tconsole.log(\"Message [\" + topic + \"]>> \", message)\n\n\tif topic == \"Final/Solar\"\n\t\tsolar = message.payloadString;\n\t\t$('#solar-value').html(solar)\n\t\tsolar-meter = $('#solar-meter')\n\t\tsolar-meter.css('width', solar + \"%\")\n\t\tsolar-meter.parent().removeClass('secondary alert success medium')\n\t\tsolar = parseInt(solar)\n\t\tif solar >= 0 and solar < 50\n\t\t\tsolar-meter.parent().addClass('success')\n\t\telse if solar >= 50 and solar < 80\n\t\t\tsolar-meter.parent().addClass('medium')\n\t\telse if solar >= 80 and solar <= 100\n\t\t\tsolar-meter.parent().addClass('alert')\n\telse if topic == \"Final/Status\"\n\t\tmsg = message.payloadString.split(\"-\")\n\t\tif msg.length == 2 and msg[0] == \"ONLINE\"\n\t\t\tstudent_id = String(msg[1])\n\t\t\tif online_timeouts[student_id]\n\t\t\t\ttimeout = online_timeouts[student_id]\n\t\t\t\tclearTimeout(timeout)\n\t\t\t\tdelete online_timeouts[student_id]\n\t\t\t\tconsole.log(\"Clear Timeout\", student_id)\n\t\t\t$('#deviceStatus-' + student_id).prop( \"checked\", true )\n\t\t\tonline_timeouts[student_id] = setTimeout(callOnlineTimeout, 5000, student_id);\n  else if topic == \"Final/Web\"\n    msg = message.payloadString.split(\"-\")\n    if msg.length == 2 and msg[0] == \"ONLINE\"\n      student_id = String(msg[1])\n      if web_timeouts[student_id]\n        timeout = web_timeouts[student_id]\n        clearTimeout(timeout)\n        delete web_timeouts[student_id]\n        console.log(\"Clear Timeout\", student_id)\n      $('#deviceStatusWeb-' + student_id).prop( \"checked\", true )\n      web_timeouts[student_id] = setTimeout(callOnlineWebTimeout, 5000, student_id);\n\treturn;\n\nconnect = () ->\n\tclient.connect({\n\t\tonSuccess: () ->\n      client.subscribe(\"Final/Solar\")\n      client.subscribe(\"Final/Status\")\n      client.subscribe(\"Final/Web\")\n      return\n\t});\n\nconnect()"]}