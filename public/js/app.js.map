{"version":3,"sources":["app.coffee"],"names":[],"mappings":"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","file":"app.js","sourceRoot":"/source/","sourcesContent":["online_timeouts = {}\r\n\r\n$(document).foundation();\r\nconsole.log(\"Load Foundation\");\r\n\r\nclient = new Paho.MQTT.Client(\"gis.it.kmitl.ac.th\", 3000, \"judge-web\");\r\nclient.onConnectionLost = (response) ->\r\n\tif response.errorCode != 0\r\n\t\tconsole.log(\"onConnectionLost:\" + response.errorMessage)\r\n\tconnect()\r\n\treturn;\r\n\r\ncallOnlineTimeout = (student_id) ->\r\n\t$('#deviceStatus-' + student_id).prop( \"checked\", false );\r\n\tdelete online_timeouts[student_id]\r\n\tconsole.log(\"Timeout Call\", student_id);\r\n\r\nclient.onMessageArrived = (message) ->\r\n\ttopic = message.destinationName\r\n\tconsole.log(\"Message [\" + topic + \"]>> \", message)\r\n\r\n\tif topic == \"Final/Solar\"\r\n\t\tsolar = message.payloadString;\r\n\t\t$('#solar-value').html(solar)\r\n\t\tsolar-meter = $('#solar-meter')\r\n\t\tsolar-meter.css('width', solar + \"%\")\r\n\t\tsolar-meter.parent().removeClass('secondary alert success medium')\r\n\t\tsolar = parseInt(solar)\r\n\t\tif solar >= 0 and solar < 50\r\n\t\t\tsolar-meter.parent().addClass('success')\r\n\t\telse if solar >= 50 and solar < 80\r\n\t\t\tsolar-meter.parent().addClass('medium')\r\n\t\telse if solar >= 80 and solar <= 100\r\n\t\t\tsolar-meter.parent().addClass('alert')\r\n\telse if topic == \"Final/Status\"\r\n\t\tmsg = message.payloadString.split(\"-\")\r\n\t\tif msg.length == 2 and msg[0] == \"ONLINE\"\r\n\t\t\tstudent_id = String(msg[1])\r\n\t\t\tif online_timeouts[student_id]\r\n\t\t\t\ttimeout = online_timeouts[student_id]\r\n\t\t\t\tclearTimeout(timeout)\r\n\t\t\t\tdelete online_timeouts[student_id]\r\n\t\t\t\tconsole.log(\"Clear Timeout\", student_id)\r\n\t\t\t$('#deviceStatus-' + student_id).prop( \"checked\", true )\r\n\t\t\tonline_timeouts[student_id] = setTimeout(callOnlineTimeout, 5000, student_id);\r\n\treturn;\r\n\r\nconnect = () ->\r\n\tclient.connect({\r\n\t\tonSuccess: () ->\r\n\t\t\tclient.subscribe(\"Final/Solar\")\r\n\t\t\tclient.subscribe(\"Final/Status\")\r\n\t\t\treturn\r\n\t});\r\n\r\nconnect()"]}