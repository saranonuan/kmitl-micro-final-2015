{"version":3,"sources":["app.coffee"],"names":[],"mappings":"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","file":"app.js","sourceRoot":"/source/","sourcesContent":["online_timeouts = {}\nweb_timeouts = {}\n\n$(document).foundation();\nconsole.log(\"Load Foundation\");\n\nclient = new Paho.MQTT.Client(\"gis.it.kmitl.ac.th\", 3000, \"judge-web\");\nclient.onConnectionLost = (response) ->\n  if response.errorCode != 0\n    console.log(\"onConnectionLost:\" + response.errorMessage)\n  connect()\n  return;\n\ncallOnlineTimeout = (student_id) ->\n  $('#deviceStatus-' + student_id).prop(\"checked\", false);\n  delete online_timeouts[student_id]\n  console.log(\"Timeout Call\", student_id);\n\ncallOnlineWebTimeout = (student_id) ->\n  $('#deviceStatusWeb-' + student_id).prop(\"checked\", false);\n  delete web_timeouts[student_id]\n  console.log(\"Timeout Call\", student_id);\n\nclient.onMessageArrived = (message) ->\n  topic = message.destinationName\n  console.log(\"Message [\" + topic + \"]>> \", message)\n\n  if topic == \"Final/Solar\"\n    solar = message.payloadString;\n    $('#solar-value').html(solar)\n    solar - meter = $('#solar-meter')\n    solar - meter.css('width', solar + \"%\")\n    solar - meter.parent().removeClass('secondary alert success medium')\n    solar = parseInt(solar)\n    if solar >= 0 and solar < 50\n      solar - meter.parent().addClass('success')\n    else if solar >= 50 and solar < 80\n      solar - meter.parent().addClass('medium')\n    else if solar >= 80 and solar <= 100\n      solar - meter.parent().addClass('alert')\n  else if topic == \"Final/Status\"\n    msg = message.payloadString.split(\"-\")\n    if msg.length == 2 and msg[0] == \"ONLINE\"\n      student_id = String(msg[1])\n      if online_timeouts[student_id]\n        timeout = online_timeouts[student_id]\n        clearTimeout(timeout)\n        delete online_timeouts[student_id]\n        console.log(\"Clear Timeout\", student_id)\n      $('#deviceStatus-' + student_id).prop(\"checked\", true)\n      online_timeouts[student_id] = setTimeout(callOnlineTimeout, 5000, student_id);\n  else if topic == \"Final/Web\"\n    msg = message.payloadString.split(\"-\")\n    if msg.length == 2 and msg[0] == \"ONLINE\"\n      student_id = String(msg[1])\n      if web_timeouts[student_id]\n        timeout = web_timeouts[student_id]\n        clearTimeout(timeout)\n        delete web_timeouts[student_id]\n        console.log(\"Clear Timeout\", student_id)\n      $('#deviceStatusWeb-' + student_id).prop(\"checked\", true)\n      web_timeouts[student_id] = setTimeout(callOnlineWebTimeout, 5000, student_id);\n  return;\n\nconnect = () ->\n  client.connect({\n    onSuccess: () ->\n      client.subscribe(\"Final/Solar\")\n      client.subscribe(\"Final/Status\")\n      client.subscribe(\"Final/Web\")\n      return\n  });\n\nconnect()"]}